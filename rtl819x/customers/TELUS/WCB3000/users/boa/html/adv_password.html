<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Change Password</title>
<%actInclude("wcb_common.html")%>

<script language="javascript">

var id_currentpass, id_newpass, id_renewpass;
var password_form;
var apply_btn;
var aContent = new Array();
var tContent = new Array();

function doLoad()
{
	id_currentpass = document.getElementById("id_currentpass");
	id_newpass = document.getElementById("id_newpass");
	id_renewpass = document.getElementById("id_renewpass");
	password_form = document.getElementById("password_form");
	apply_btn = document.getElementById("diy_apply_btn");

	apply_btn.onclick = doApply;	
	id_currentpass.focus();
	id_currentpass.value="";
	init_language();
}

function alert_message()
{
	var urlArray = (window.location.href).split("?");
	if(urlArray[1] == "k=1")
	{
		pop_up(aContent[0]);	
		id_currentpass.focus();	
		return;
	}
	else if(urlArray[1] == "k=0")
	{
		pop_up(aContent[1]);	
		id_currentpass.focus();	
		return;
	}
}

function init_language()
{
	if(cur_lang=="1")
		var surl = "xml/adv_password_en.xml";
	else
		var surl = "xml/adv_password_fr.xml";
	StartGetMULLanageXML(surl);
}

function DrawHtml(atemp,ttemp)
{
	 tContent = ttemp;
	 aContent = atemp;


	document.getElementById("chan_pass_title").innerHTML = tContent[0]; 
	document.getElementById("chan_cur_ps").innerHTML = tContent[1]; 
	document.getElementById("chan_new_ps").innerHTML = tContent[2]; 
	document.getElementById("chan_re_pw").innerHTML = tContent[3];
	document.getElementById("apply_btn_span").innerHTML = tContent[4]; 
	if(cur_lang=="1")
	{
		get_top_bottom_en();
		adv_get_Left_en();
	}
	else
	{
		get_top_bottom_fr();
		adv_get_Left_fr();
	}
	
	alert_message();
}



function doApply()
{
	if(trim(id_currentpass.value) == "")
	{
		pop_up(aContent[2]);
		id_currentpass.focus();
		return;
	}
	else if(trim(id_currentpass.value).indexOf("|") != -1)
	{
		pop_up(aContent[3]);
		id_currentpass.focus();
		return;
	}

	if(trim(id_newpass.value) == "")
	{
		pop_up(aContent[4]);
		id_newpass.focus();
		return;
	}
	else if(trim(id_newpass.value).indexOf("|") != -1)
	{
		pop_up(aContent[5]);
		id_newpass.focus();
		return;
	}
	else if(trim(id_newpass.value).indexOf(" ") != -1)
	{
		pop_up(aContent[5]);
		id_newpass.focus();
		return;
	}

	if(id_newpass.value != id_renewpass.value)
	{
		pop_up(aContent[6]);
		id_renewpass.focus();
		return;
	}
	
	password_form.submit();

	/*
	var params = "&command=apply"
	           + "&mypage=/adv_password.html"
	           + "&currentpass=" + trim(id_currentpass.value)
	           + "&newpass=" + trim(id_newpass.value); 	

	ajaxPost("advpassword.cgi", params, resGetValue);
	*/
}

function resGetValue(message)
{
	if(message == "0")
		pop_up("Change Password Successful");
	else if(message == "1")
		pop_up("Error! Current Password is not right");
}

</script>
</head>

<body>
	<div id="wrapper">    
		<%actInclude("top_nav.html")%>    
		<%actInclude("left_adv.html")%>
		
		<div id="content_right">
		    <div id="content_right_header"></div>
		    <div id="content_right_contentarea">
	        	<h1><span id="chan_pass_title" style='font-weight:bold;font-size:16px;'>Change Password</span></h1>

				<form id="password_form" method="post" action="advpassword.cgi">      
		        <input type="hidden" name="command" value="apply" />
				<input type="hidden" name="mypage" value="/adv_password.html" />		      
        
				<table cellpadding="0" cellspacing="2" border="0">
		        	<tr>
						<td width="250"><label for="id_currentpass"><span id="chan_cur_ps">Current Password</span>:</label></td>
						<td>
							<input name="currentpass" id="id_currentpass" type="password" size="25" maxlength="32" style="height: 16px"/> 
						</td>
					</tr>
					<tr>
						<td width="250"><label for="id_newpass"><span id="chan_new_ps">New Password</span>:</label></td>
						<td>
							<input name="newpass" id="id_newpass" type="password" size="25" maxlength="32" style="height: 16px"/> 
						</td>
					</tr>
					<tr>
						<td width="250"><label for="id_renewpass"><span id="chan_re_pw">Re-enter New Password</span>:</label></td>
						<td>
							<input id="id_renewpass" type="password" size="25" maxlength="32" style="height: 16px"/>
						</td>
					</tr>
		        </table>
		        </form>

		        <table cellpadding="0" cellspacing="2" border="0">
					<tr>
						<td width="220">&nbsp;</td>
						<td>
							<div><a class="button" href="###" id="diy_apply_btn"><span id="apply_btn_span">Apply</span></a></div>
						</td>
					</tr>
			</table>
				
	        	<div class="clear_left"></div>
	        </div>
	        <div id="content_right_footer"></div>
		</div>
        <div class="clear_left"></div>
   		<%actInclude("wcb_footer.html")%>
	</div>
</body>
</html>
