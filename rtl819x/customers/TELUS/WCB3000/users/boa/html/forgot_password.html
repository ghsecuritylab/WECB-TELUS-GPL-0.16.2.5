<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Reset Password</title>
<%actInclude("wcb_common.html")%>
<link href="css/login_20121119.css" rel="stylesheet" type="text/css" />
</head>
<script language="javascript">

var serial_number, new_password,re_enter_password;
var change_btn,cancel_btn;
var forgotpasswd_form;
var device_serial_num = "";
var aContent = new Array();
var tContent = new Array();

document.onkeydown = function(e){

	var keycode;
	
	if(navigator.appName == "Microsoft Internet Explorer")
	{
		keycode = event.keyCode;
	}
	else
	{
		keycode = e.which;
	}

	switch (keycode)
	{
		case 13: 	// Enter
			loginCheck();
			break;
		default:
			break;
	}
}

function doLoad() 
{
	serial_number = document.getElementById("serial_number");
	new_password = document.getElementById("new_password");
	re_enter_password= document.getElementById("re_enter_password");
	change_btn = document.getElementById("change_btn");
	cancel_btn = document.getElementById("cancel_btn");
	forgotpasswd_form = document.getElementById("forgotpasswd_form");

	change_btn.onclick = changeThePassword;
	cancel_btn.onclick = backToHomepage;
	
	getDeviceSerialNum();
	serial_number.focus();
	serial_number.value = "";
	new_password.value = "";
	re_enter_password.value = "";
	init_language();
}

function init_language()
{
	if(cur_lang=="1")
		var surl = "xml/forgot_password_en.xml";
	else
		var surl = "xml/forgot_password_fr.xml";
	StartGetMULLanageXML(surl);
}

function DrawHtml(atemp,ttemp)
{
	 tContent = ttemp;
	 aContent = atemp;


	document.getElementById("reset_title").innerHTML = tContent[0]; 
	document.getElementById("reset_note").innerHTML = tContent[1]; 
	document.getElementById("reset_seril").innerHTML = tContent[2]; 
	document.getElementById("reset_pass").innerHTML = tContent[3]; 
	document.getElementById("reset_repasswd").innerHTML = tContent[4]; 
	document.getElementById("res_app").innerHTML = tContent[5]; 
	document.getElementById("res_cancel").innerHTML = tContent[6]; 
}


function getDeviceSerialNum()
{
	var params = "";
	params += "&command=getvalue";		
	ajaxPost("gotserialnum.cgi", params, resGetValue);
}

function resGetValue(message)
{
	device_serial_num = message;
}

function backToHomepage()
{
	goThere('wcb_home.html');
}


function changeThePassword()
{
	if(serial_number.value == "")
	{
		pop_up(aContent[0]);
		serial_number.focus();
		return;
	}

	if(serial_number.value != device_serial_num)
	{
		pop_up(aContent[1]);
		serial_number.focus();
		return;
	}

	if(new_password.value == "")
	{
		pop_up(aContent[2]);
		new_password.focus();
		return;
	}

	if(re_enter_password.value == "")
	{
		pop_up(aContent[3]);
		new_password.focus();
		return;
	}

	if(re_enter_password.value != new_password.value)
	{
		pop_up(aContent[4]);
		re_enter_password.focus();
		return;
	}
	
	forgotpasswd_form.submit();
}

</script>

<body>
<script  language="Javascript">
	var top_langstat =  "<% getIndex("telus_langstat"); %>";
	var top_cur_lang = "";
	if(top_langstat==""||top_langstat=="NULL")
		top_langstat = "0";
	if(top_langstat=="0")
		{
			 var Browser_Agent=window.navigator.userAgent;
			 if(Browser_Agent.indexOf("MSIE")!=-1){
			 	if(window.navigator.browserLanguage.indexOf("fr")!=-1)
					top_cur_lang = "2";
				else
					top_cur_lang = "1";
			 }
			 else{//firefox opera safari
			 	if(window.navigator.language.indexOf("fr")!=-1)
					top_cur_lang = "2";
				else
					top_cur_lang = "1";
			 }
		}
	else
		top_cur_lang = top_langstat;
</script>
<div id="logo_home">
	<a href="http://www.telus.com">
	<script language="Javascript">
		if(top_cur_lang=="2")
			document.write('<img src="images/fr_logo.png" />');
		else
			document.write('<img src="images/logo.jpg" />');
	</script>		
	</a>
</div>
<div id="wrapper">
    <div id="login_div">
		<div id="login_content_div">
			<table border=0 cellSpacing=0 cellPadding=0 width="100%">
				<tr height="40">
					<td align="center"><strong><span id="reset_title" class=PAGE_HEADER style='font-weight:bold;font-size:16px;'>Reset Password</span></strong></td>
				</tr>
				<tr height="30">
					<td align="center" valign="middle"><span id="reset_note">To reset the password for the device, you must enter the serial number found on the label on the bottom of the device, and then enter a new password.</span></td>
				</tr>
			</table>
			<BR>

			<form method="post" name="forgotpasswd_form" id="forgotpasswd_form" action="forgotpassword.cgi">
			<input type="hidden" name="mypage" value="/wcb_home.html" />
			<input type="hidden" name="top_chanpass_li" id="top_chanpass_li" value="" />
			
				<table border=0 cellSpacing=0 cellPadding=4 width="100%" style="display:none;">
					<tr class=ODD>
						<td class=GRID_3D_NO_RIGHT width="50%"><strong>Serial Number</strong>:</td>
						<td class=GRID_3D_NO_LEFT width="50%">
							<INPUT style="WIDTH: 150px" maxLength=64 id="for_chrome_cache1" name="for_chrome_cache1" value=""/>
						</td>
					</tr>
					<tr class=EVEN>
						<td class=GRID_3D_NO_RIGHT width="50%"><strong>New Password</strong>:</td>
						<td class=GRID_3D_NO_LEFT width="50%">
							<INPUT style="WIDTH: 150px;" maxLength=64 type=password id="for_chrome_cache2" name="for_chrome_cache2" value=""/>
						</td>
					</tr>
					<tr class=ODD>
						<td class=GRID_3D_NO_RIGHT width="50%"><strong>Re-enter New Password</strong>:</td>
						<td class=GRID_3D_NO_LEFT width="50%">
							<INPUT style="WIDTH: 150px;" maxLength=64 type=password id="for_chrome_cache3" name="for_chrome_cache3" value=""/>
						</td>
					</tr>
				</table>
			
				<table border=0 cellSpacing=0 cellPadding=4 width="100%">
					<tr class=ODD>
						<td class=GRID_3D_NO_RIGHT width="50%"><strong><span id="reset_seril">Serial Number</span></strong>:</td>
						<td class=GRID_3D_NO_LEFT width="50%">
							<INPUT style="WIDTH: 150px" maxLength=64 id="serial_number" name="serial_number" value=""/>
						</td>
					</tr>
					<tr class=EVEN>
						<td class=GRID_3D_NO_RIGHT width="50%"><strong><span id="reset_pass">New Password</span></strong>:</td>
						<td class=GRID_3D_NO_LEFT width="50%">
							<INPUT style="WIDTH: 150px;" maxLength=64 type=password id="new_password" name="new_password" value=""/>
						</td>
					</tr>
					<tr class=ODD>
						<td class=GRID_3D_NO_RIGHT width="50%"><strong><span id="reset_repasswd">Re-enter New Password</span></strong>:</td>
						<td class=GRID_3D_NO_LEFT width="50%">
							<INPUT style="WIDTH: 150px;" maxLength=64 type=password id="re_enter_password" name="re_enter_password" value=""/>
						</td>
					</tr>
				</table>
					
				<BR>
				<table border=0 cellSpacing=0 cellPadding=0 width="100%">
					<tr>
						<td width="48%"><a href="###" class="button1" id="change_btn"><span id="res_app">Apply</span></a></td>
						<td width="2%">&nbsp;</td>
						<td width="50%"><a href="###" class="button" id="cancel_btn"><span id="res_cancel">Cancel</span></a></td>
					</tr>
				</table>
			</form>
		</div>
	</div>
</div>
</body>
</html>

